<?xml version="1.0" encoding="iso-8859-1"?>
<idea-plugin>
  <name>Tapestry support</name>
  <id>com.intellij.tapestry</id>
  <version>1.0</version>
  <vendor>JetBrains</vendor>
  <description>Provides Tapestry 5.1 integration.</description>

  <depends>com.intellij.javaee</depends>
  <category>Web/JavaEE Technologies</category>

  <!--<helpset file="help.jar" path="/Help.hs"/>-->
  <depends optional="true" config-file="intellilang-tapestry-support.xml">org.intellij.intelliLang</depends>

  <extensions defaultExtensionNs="com.intellij">
    <errorHandler implementation="com.intellij.diagnostic.ITNReporter"/>
    <facetType implementation="com.intellij.tapestry.intellij.facet.TapestryFacetType"/>
    <framework.detector implementation="com.intellij.tapestry.intellij.facet.TapestryFacetType$TapestryFrameworkDetector"/>
    <frameworkSupport implementation="com.intellij.tapestry.intellij.facet.TapestryFrameworkSupportProvider"/>

    <fileTemplateGroup implementation="com.intellij.tapestry.intellij.TapestryFileTemplateGroupFactory"/>

    <colorSettingsPage implementation="com.intellij.tapestry.intellij.lang.TemplateColorSettingsPage"/>
    <standardResourceProvider implementation="com.intellij.tapestry.intellij.TapestryResourceProvider"/>

    <fileTypeFactory implementation="com.intellij.tapestry.lang.TmlFileTypeFactory"/>
    <typedHandler implementation="com.intellij.tapestry.lang.TmlTypedHandler"/>
    <lang.fileViewProviderFactory language="TML" implementationClass="com.intellij.tapestry.lang.TmlFileViewProviderFactory"/>
    <syntaxHighlighter key="TML" implementationClass="com.intellij.tapestry.lang.TmlHighlighter"/>
    <lang.parserDefinition language="TML" implementationClass="com.intellij.tapestry.psi.TmlParserDefinition"/>
    <lang.parserDefinition language="TEL" implementationClass="com.intellij.tapestry.psi.TelParserDefinition"/>

    <multiHostInjector implementation="com.intellij.tapestry.intellij.lang.TelLanguageInjector" />
    <annotator language="TML" implementationClass="com.intellij.tapestry.intellij.lang.annotator.TemplateTagAnnotator"/>

    <psi.referenceContributor implementation="com.intellij.tapestry.intellij.lang.reference.TapestryReferenceContributor"/>

    <xml.xmlExtension implementation="com.intellij.tapestry.intellij.lang.descriptor.TapestryXmlExtension"/>

    <xml.schemaProvider implementation="com.intellij.tapestry.intellij.lang.descriptor.TapestrySchemaProvider"/>

    <xml.elementDescriptorProvider implementation="com.intellij.tapestry.intellij.lang.descriptor.TapestryTagDescriptorProvider"/>

    <lang.formatter language="TML" implementationClass="com.intellij.lang.xhtml.XhtmlFormattingModelBuilder"/>

    <completionData fileType="TML" className="com.intellij.tapestry.intellij.lang.completion.TemplateCompletionData"/>

    <lang.findUsagesProvider language="TML"
                             implementationClass="com.intellij.tapestry.intellij.editorActions.TmlFindUsagesProvider"/>
    <lang.findUsagesProvider language="TEL"
                             implementationClass="com.intellij.tapestry.intellij.editorActions.TmlFindUsagesProvider"/>
    <methodReferencesSearch implementation="com.intellij.tapestry.intellij.editorActions.TapestryMethodReferenceSearcher"/>
    <referencesSearch implementation="com.intellij.tapestry.intellij.editorActions.TapestryPropertyReferenceSearcher"/>
    <implicitUsageProvider implementation="com.intellij.tapestry.intellij.TapestryImplicitUsageProvider"/>

    <lang.commenter language="TML" implementationClass="com.intellij.lang.xml.XmlCommenter"/>
    <lang.foldingBuilder language="TML" implementationClass="com.intellij.lang.xml.XmlFoldingBuilder"/>
    <codeInsight.parameterInfo language="TML" implementationClass="com.intellij.codeInsight.hint.api.impls.XmlParameterInfoHandler"/>
    <lang.psiStructureViewFactory language="TML" implementationClass="com.intellij.lang.xml.XmlStructureViewBuilderFactory"/>
    <!--<codeInsight.wordCompletionFilter language="TML" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>-->
    <!--<lang.smartEnterProcessor language="TML" implementationClass="com.intellij.codeInsight.completion.XmlSmartEnterProcessor"/>-->
    <!--<braceMatcher filetype="TML" implementationClass="com.intellij.xml.impl.XmlBraceMatcher"/>-->
    <!--<quoteHandler fileType="TML" className="com.intellij.codeInsight.editorActions.HtmlQuoteHandler"/>-->

    <facet.toolWindow id="Tapestry"
                      facetIdList="tapestry"
                      anchor="bottom"
                      secondary="false"
                      icon="TapestryIcons.TapestryToolWindow"
                      factoryClass="com.intellij.tapestry.intellij.toolwindow.TapestryToolWindowFactory"/>

    <projectViewPane implementation="com.intellij.tapestry.intellij.view.TapestryProjectViewPane"/>

    <localInspection language="TEL" shortName="TelReferencesInspection" bundle="messages.TapestryBundle" key="tel.references.inspection"
                     groupKey="tapestry.inspections.group" enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.tapestry.intellij.inspections.TelReferencesInspection"/>
    <moduleService serviceImplementation="com.intellij.tapestry.intellij.TapestryModuleSupportLoader"/>
  </extensions>

  <actions>
    <action class="com.intellij.tapestry.intellij.actions.navigation.ClassTemplateNavigation"
            id="ClassTemplateNavigation" text="Class &lt;-&gt; Template Navigation"
            description="Navigate from a class to it's corresponding template and vice-versa.">
      <keyboard-shortcut first-keystroke="control shift G" keymap="$default"/>
    </action>

    <action class="com.intellij.tapestry.intellij.actions.navigation.TagDocumentationNavigation"
            id="TagDocumentationNavigation" text="Tag to Documentation Navigation"
            description="Navigate from a tag to it's corresponding documentation.">
      <keyboard-shortcut first-keystroke="control shift D" keymap="$default"/>
    </action>

    <group id="GoToTapestryTemplate"
           class="com.intellij.tapestry.intellij.actions.navigation.TemplatesNavigation"
           text="Tapestry Template" description="Go to template." popup="true">
      <add-to-group group-id="EditorPopupMenu.GoTo" anchor="last"/>
    </group>

    <group id="GoToTapestryClass" text="GoToClass">
      <separator/>
      <action id="GoToClass"
              class="com.intellij.tapestry.intellij.actions.navigation.ClassTemplateNavigation"
              text="Tapestry Class" description="Go to class.">
        <keyboard-shortcut first-keystroke="control shift G" keymap="$default"/>
      </action>
      <add-to-group group-id="EditorPopupMenu.GoTo" anchor="last"/>
    </group>

    <group id="TapestryGroup" popup="true" text="Tapestry" class="com.intellij.ide.actions.NonEmptyActionGroup">
      <separator/>
      <action id="AddNewPageAction"
              class="com.intellij.tapestry.intellij.actions.createnew.AddNewPageAction"
              text="Page" description="Add a new page."/>
      <action id="AddNewComponentAction"
              class="com.intellij.tapestry.intellij.actions.createnew.AddNewComponentAction"
              text="Component" description="Add a new component."/>
      <action id="AddNewMixinAction"
              class="com.intellij.tapestry.intellij.actions.createnew.AddNewMixinAction"
              text="Mixin" description="Add a new mixin."/>
      <add-to-group group-id="NewGroup" relative-to-action="NewAction" anchor="after"/>
    </group>
  </actions>

  <application-components>
    <component>
      <implementation-class>com.intellij.tapestry.intellij.TapestryApplicationSupportLoader</implementation-class>
    </component>
  </application-components>

  <project-components>
    <component>
      <implementation-class>com.intellij.tapestry.intellij.TapestryListenersSupportLoader</implementation-class>
    </component>
  </project-components>

</idea-plugin>
